# 기능 목록

- [x] 상품 관리 CRUD API 작성
    - [x] 상품 정보를 담는 객체를 생성한다
        - [x] (검증) 같은 이름, 같은 가격은 가질 수 없다.
        - [x] (검증) 이름은 10자 이상일 수 없다.
        - [x] (검증) 이름은 Blank일 수 없다.
        - [x] (검증) 이미지 `URL`은 `http`혹은 `https`로 시작해야 한다.
        - [x] (검증) 가격은 0 혹은 양수여야 한다.
        - [x] (검증) 가격은 1,000,000이하 여야한다.
    - [x] 해당 객체에 대해서, 아래와 같은 오퍼레이션을 수행할 수 있다.
        - [x] CREATE
        - [x] READ
        - [x] UPDATE
        - [x] DELETE
          <br><br>
- [x] 상품 목록 페이지 연동
    - [x] index.html 파일을 이용해 상품 목록이 노출되는 페이지를 완성한다.
    - [x] / url로 접근할 경우 상품 목록 페이지를 조회할 수 있다.
    - [x] 상품 기본 정보의 종류를 추가할 수 있다.(상품 설명, 상품 카테고리)
      <br><br>
- [x] 관리자 도구 페이지 연동
    - [x] admin.html 파일과 CRUD API를 이용해 상품 관리 페이지를 구현한다.
    - [x] /admin url로 접근할 경우 관리자 도구 페이지를 조회할 수 있다.
    - [x] 상품 추가, 수정, 삭제 기능이 동작한다.
    <br><br>
- [ ] 사용자 기능 구현
    - [ ] 사용자는 기본적으로 email, password 를 가진다.
    - [ ] 필요한 경우, 사용자 정보의 종류를 추가할 수 있다.
    <br><br>
- [ ] 사용자 설정 페이지 연동
    - [ ] `settings.html`에서 모든 사용자의 정보를 확인할 수 있다.
    - [ ] `settings.html`에서 사용자를 선택할 수 있다.
    - [ ] 사용자를 선택하면, 이후 요청에 선택한 사용자의 인증 정보가 포함된다.


# 기록 📕
<details>
<summary>미션 중 고민했던 것들</summary>
<div>

1. domain 객체의 생성자에서(domain 객체를 생성할 때) 항상 null을 체크해줘야하는가?
    - 테오: null 체크를 하지 않는 것이 관례라고 알고있음. 또, 어짜피 NPE가 발생되면 프로그램이 정상 작동하지 않을 것.
    - 주디: 개발자에게 있어서 가장 최악의 시나리오는 프로그램이 비정상종료되면서 shutdown되는 것이라 생각한다. 따라서 Null검사를 하지않으면 이와 같은 상황을 발생하게 둔다는 말인데 이게 괜찮은 건지
      모르겠다.
    - 결론: 프리코스, level1에서는 요구사항으로 IllegalArgumentException()을 던지도록 했다. 새로운 예외를 던질 필요가 없고 null check를 하지 않는 게 관행이라면 그 관행을
      따르는 것도 좋을 것 같다.
2. TDD를 할 때,각각의 테스트는 항상 독립적이야 하는가? 하나의 테스트가 다른 하나의 테스트 범위를 포함해도 되는가?
    - 테오: ProductImage가 잘 생성되는지에 대한 테스트 코드를 작성할 때, TDD 정신을 따르기 위해 test가 fail하는 걸 보고자했다. 그래서 ProductImage class 생성자에 예외처리
      코드를 추가하고 이를 확인했다.
    - 주디: 하지만 이렇게 되면 예외 테스트가 실패해야하는데 성공이 되지 않나? 테스트는 각각 독립적이어야하는데 어떻게 보면 서로 영향이 가는 상황 아닌가?
3. URL, URI 중 어느 것을 사용할지 고민하다가, URI는 Identifier를 표현하는 성향이 강하기 때문에 '웹 주소'만을 표현하기 위해 보다 한정적인 의미를 가지는 URL을 사용했음.
4. Test Class에 WebMvcTest를 붙인 이유는 실제 서버를 구동하지 않고 테스트를 작성하기 위함인데, 언제 사용하는게 적절할지?
5. Service를 CRUD마다 쪼개면 SRP를 쉽게 지킬 수 있다. 쪼갰을 때 응집도가 Product 기준에서는 낮아지지만, CRUD관점에서는 높아지는 느낌이다. 어느 것을 선택할까?
6. Product 객체에 ID를 처음에는 넣지 않으려다가, 결국 넣게 되었는데 ID를 사용하지 않고 구현하는 방법이 있는가?
7. WebController, ProductController를 나눈 이유는 CRUD용 컨트롤러랑 뷰용 컨트롤러가 성격이 다르다고 느껴졌기 때문.
8. 사용자가 유효하지 않은 값을 입력해서 Exception이 터졌다면, Logger를 이용할 때 error를 써야하는가? debug를 써야하는가?
    - 주디: 사용자의 유효하지 않은 입력은 예외라고 생각한다. 개발자가 예외처리를 해줬어도 정상적인 흐름이 아니기 때문에 사용자 요청에 대해 발생한 문제라고 생각한다. 그래서 logger.error()를
      사용해야한다고 생각한다
    - 테오: 개발자가 예외처리를 해줬고 시스템에 영향이 가지 않으면 정상적인 흐름이라고 생각한다. 따라서 logger.info() 혹은 logger.debug()가 맞는 것 같다.

</div>
</details>

<details>
<summary>무엇을 리팩토링했는지</summary>
<div>

- [x] Service에 DTO 개념을 붙이고 싶지 않다. 반면 Controller에서도 도메인에 대한 결합도를 높이고 싶지는 않다. 두 방식은 모두 극단적이라 생각. 따라서 새로운 레이어 생성.
    - [x] Application Layer를 중간에 생성함으로써 DTO <-> 도메인 변환작업을 전담.
    - [x] `Open Layer`로 둠으로써 표현 계층에서 선택적으로 접근할 수 있게 하면 어떨까.
    - [x] 이것이 좋은 방향인지는 카프카와 논의해봐야 할 듯!
- [x] `IdSequencer`를 통해 DB 아이디와 Product ID 두 개념을 분리
    - [x] 이제 도메인 엔티티와 DB 엔티티는 완전히 독립적임
- [x] `DELETE` 시 전체 product를 통해 삭제하는 것이 아닌, id를 통해 삭제하도록 변경
- [x] Repository에 `findByName` 메소드 추가, 쿼리 최적화
    - [x] Repository에 이런 기능이 들어가는 것을 두려워하지 말자! 성능 최적화를 위해. Repo에는 보편적인 기능만 들어갈 필요는 없다.
- [x] CRUD service 통합
    - [x] 자원이 아닌 비즈니스 중심으로 서비스를 구성해야 한다는 생각은 있지만, CRUD 분리는 너무 과하다는 생각이 들음.
    - [x] 따라서 이런 철학은 유지하되, 상황에 따라 trade-off를 계산해 자원 중심으로도 service를 만들 수 있어야 할듯.
- [x] request DTO 검증로직 추가
    - [x] 어디까지 검증할 것인지? 는 카프카와 함께 더 이야기 해 보아야 할 듯.
    - [x] 일단은 데이터 자체에 대한 검증 (notNull, Positive 등)만 수행함.
- [x] Application 계층을 위한 커스텀 어노테이션 `@Application` 생성
    - [x] `@Component`와 동일한 역할을 하지만 명시적인 효과
- [x] SpringBootTest -> WebMvcTest로 개선
    - [x] Mockito, MockMVC 사용
- [x] CRUD -> GET, POST, PUT, DELETE에 각각 매핑
    - [x] URL에서 method 관련 정보가 사라짐, 자원만 명시(`/product`)
- [x] Optional을 stream처럼 다루기
    - [x] 기본 null check 스타일에서 벗어나 깔끔한 코드 구성 가능
    - [x] 구현한 사람에 의도에 맞는 사용법
    - [x] https://www.daleseo.com/java8-optional-effective/

</div>
</details>